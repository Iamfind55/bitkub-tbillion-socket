<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h2>hi how are you</h2>

    <ul id="list">
        <li style="font-size: 15pt; text-align: center; list-style: none;">List message chat</li>
    </ul>
    <div class="display:flex">
        <input type="text" id="name" placeholder="username"
            style="height: 40px; width: 100%; padding: 10px ;font-size: 20px;">
        <textarea placeholder="detail" id="message" rows="3"
            style="width: 100%; padding: 10px ;font-size: 20px; margin-top: 10px;"></textarea>

        <button id="send" style="padding: 10px; background-color: aqua;">Send Message</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        // get url from env file
        const socket = io('http://localhost:3636/', {
            transports: ['websocket'],
            upgrade: false,
            parameters: {
                route: 'trade',
            }
        });
        socket.on('connect', () => {
            console.log('connected');
        });


        socket.on('disconnect', () => {
            console.log('disconnected');
        });

        socket.on('error', (err) => {
            console.log(err);
        });

        socket.on('reconnect', (attemptNumber) => {
            console.log(attemptNumber);
        });

        socket.emit('message', 'hello world, i am client')

        document.getElementById('send').addEventListener('click', () => {
            let name = document.getElementById('name').value;
            let message = document.getElementById('message').value;
            socket.emit('message', { name, message });
            // clear input
            document.getElementById('message').value = '';
        });

        socket.on('message', (data) => {
            console.log(data);
            if (data.name) {
                let list = document.getElementById('list');
                let li = document.createElement('li');
                li.innerHTML = `<b>${data.name}</b> : ${data.message}`;
                list.appendChild(li);
            }
        });
    </script>
</body>


</html>